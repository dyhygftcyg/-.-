<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ù†ÙˆØ±Ø© Ù„Ù„Ø®Ø¯Ù…Ø§Øª - Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙƒØ§Ù…Ù„</title>
    
    <link rel="apple-touch-icon" href="https://r.jina.ai/i/0196887a270776b6b7ba904620f592ba">
    <link rel="shortcut icon" href="https://r.jina.ai/i/0196887a270776b6b7ba904620f592ba">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root {
            --accent: #ff7eb9; --success: #10b981; --danger: #ef4444; --warning: #f59e0b;
            --text-main: #ffffff; --glass-bg: rgba(15, 23, 42, 0.9);
        }
        body {
            font-family: 'Segoe UI', Tahoma, sans-serif; margin: 0; padding: 15px;
            background: #0f172a url('https://images.unsplash.com/photo-1616348436168-de43ad0db179?q=80&w=2000&auto=format&fit=crop') no-repeat center center fixed;
            background-size: cover; color: var(--text-main); min-height: 100vh;
        }
        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.4); z-index: -1; }
        
        #loginOverlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            display: flex; align-items: center; justify-content: center;
            backdrop-filter: blur(20px); z-index: 1000; background: rgba(15, 23, 42, 0.7);
        }
        .login-card { background: var(--glass-bg); padding: 35px; border-radius: 20px; text-align: center; width: 300px; border: 1px solid rgba(255,255,255,0.1); }

        #mainApp { display: none; max-width: 1250px; margin: auto; }
        header, .glass-card, .stat-card { 
            background: var(--glass-bg); backdrop-filter: blur(12px); 
            border-radius: 15px; border: 1px solid rgba(255,255,255,0.1); padding: 15px; margin-bottom: 15px;
        }

        .stats-bar { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px; }
        .stat-card p { margin: 10px 0 0; font-size: 1.5rem; font-weight: bold; color: var(--accent); }

        .main-grid { display: grid; grid-template-columns: 320px 1fr; gap: 15px; }
        input, select { width: 100%; padding: 12px; margin: 5px 0 10px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.2); background: rgba(0,0,0,0.4); color: white; box-sizing: border-box; }
        
        button { width: 100%; padding: 12px; border-radius: 8px; border: none; font-weight: bold; cursor: pointer; transition: 0.3s; }
        .btn-add { background: var(--accent); color: white; }
        .btn-sell { background: var(--success); color: white; width: auto; padding: 4px 10px; }
        .btn-danger { background: var(--danger); color: white; margin-top: 10px; font-size: 0.8rem; }
        
        table { width: 100%; border-collapse: collapse; font-size: 0.9rem; }
        th, td { text-align: right; padding: 10px; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .price-text { color: var(--success); font-weight: bold; }

        @media (max-width: 768px) { .main-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

<div class="overlay"></div>

<div id="loginOverlay">
    <div class="login-card">
        <h2 style="color: var(--accent);">Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ù†ÙˆØ±Ø©</h2>
        <input type="text" id="userIn" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
        <input type="password" id="passIn" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
        <button class="btn-add" onclick="handleLogin()">Ø¯Ø®ÙˆÙ„ Ù„Ù„Ù†Ø¸Ø§Ù…</button>
    </div>
</div>

<div id="mainApp">
    <header style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px;">
        <h1 style="margin: 0; font-size: 1.5rem;">Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ù†ÙˆØ±Ø© Ù„Ù„Ø®Ø¯Ù…Ø§Øª</h1>
        <div style="display: flex; gap: 10px;">
            <button onclick="exportToExcel()" style="background: #1d6f42; width: auto;">Excel</button>
            <button onclick="location.reload()" style="background: #475569; width: auto;">Ø®Ø±ÙˆØ¬</button>
        </div>
    </header>

    <div class="stats-bar">
        <div class="stat-card"><h4>Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø®Ø²Ù†</h4><p id="totalInvPrice">0</p></div>
        <div class="stat-card"><h4>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</h4><p id="totalSalesCash" style="color: var(--success);">0</p></div>
        <div class="stat-card"><h4>Ø£ØµÙ†Ø§Ù Ø§Ù„Ù…Ø®Ø²Ù†</h4><p id="countInv" style="color: var(--warning);">0</p></div>
        <div class="stat-card"><h4>Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø¨ÙŠØ¹</h4><p id="countSales" style="color: var(--success);">0</p></div>
    </div>

    <div class="main-grid">
        <div class="side">
            <div class="glass-card">
                <h3>â• Ø¥Ø¶Ø§ÙØ© ØµÙ†Ù</h3>
                <input type="text" id="name" placeholder="Ø§Ø³Ù… Ø§Ù„ØµÙ†Ù">
                <input type="number" id="price" placeholder="Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØ¹">
                <select id="type"><option value="Ù‡Ø§ØªÙ">Ù‡Ø§ØªÙ</option><option value="Ø§Ø³Ø¨ÙŠØ±">Ø§Ø³Ø¨ÙŠØ±</option></select>
                <input type="text" id="detail" placeholder="Ø§Ù„ØªÙØ§ØµÙŠÙ„ / Ø§Ù„ÙƒÙ…ÙŠØ©">
                <button class="btn-add" onclick="saveItem()">Ø­ÙØ¸</button>
            </div>

            <div class="glass-card">
                <h3>âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h3>
                <button class="btn-danger" onclick="clearSales()">ğŸ—‘ï¸ Ù…Ø³Ø­ Ø³Ø¬Ù„ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</button>
                <button class="btn-danger" style="background: #7f1d1d;" onclick="clearInventory()">ğŸš¨ ØªÙØ±ÙŠØº Ø§Ù„Ù…Ø®Ø²Ù† Ø¨Ø§Ù„ÙƒØ§Ù…Ù„</button>
                <p style="font-size: 0.7rem; color: #94a3b8; margin-top: 10px;">* ØªÙ†Ø¨ÙŠÙ‡: Ø§Ù„Ø­Ø°Ù Ù†Ù‡Ø§Ø¦ÙŠ ÙˆÙ„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡.</p>
            </div>
        </div>

        <div class="content">
            <div class="glass-card">
                <h3>ğŸ’° Ø§Ù„Ø¨ÙŠØ¹ ÙˆØ§Ù„ØªØ­ØµÙŠÙ„</h3>
                <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                    <input type="text" id="cust" placeholder="Ø§Ø³Ù… Ø§Ù„Ø²Ø¨ÙˆÙ† (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
                    <input type="number" id="paid" placeholder="Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¯ÙÙˆØ¹">
                </div>
                <h3>ğŸ“¦ Ø§Ù„Ù…Ø®Ø²Ù† Ø§Ù„Ø­Ø§Ù„ÙŠ</h3>
                <table id="invTable">
                    <thead><tr><th>Ø§Ù„ØµÙ†Ù</th><th>Ø§Ù„ØªÙØ§ØµÙŠÙ„</th><th>Ø§Ù„Ø³Ø¹Ø±</th><th>Ø¥Ø¬Ø±Ø§Ø¡</th></tr></thead>
                    <tbody></tbody>
                </table>
            </div>

            <div class="glass-card">
                <h3>âœ… Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„Ø£Ø®ÙŠØ±</h3>
                <table id="salesTable">
                    <thead><tr><th>Ø§Ù„ØµÙ†Ù</th><th>Ø§Ù„Ù…Ø¨Ù„Øº</th><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th></tr></thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<script>
    const AUTH = { user: "Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©", pass: "009944" };

    function handleLogin() {
        if(document.getElementById('userIn').value === AUTH.user && document.getElementById('passIn').value === AUTH.pass) {
            document.getElementById('loginOverlay').style.display = 'none';
            document.getElementById('mainApp').style.display = 'block';
            render();
        } else { alert("Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø®Ø·Ø£!"); }
    }

    let inventory = JSON.parse(localStorage.getItem('m_inv')) || [];
    let sales = JSON.parse(localStorage.getItem('m_sales')) || [];

    function saveItem() {
        const name = document.getElementById('name').value;
        const price = parseFloat(document.getElementById('price').value);
        if(!name || !price) return alert("ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ø³Ø¹Ø±");

        const item = {
            name: name,
            price: price,
            type: document.getElementById('type').value,
            detail: document.getElementById('detail').value,
            qty: document.getElementById('type').value === 'Ø§Ø³Ø¨ÙŠØ±' ? parseInt(document.getElementById('detail').value) || 1 : 1
        };
        inventory.push(item);
        update();
        document.querySelectorAll('.side input').forEach(i => i.value = '');
    }

    function sell(index) {
        const item = inventory[index];
        const paid = parseFloat(document.getElementById('paid').value) || item.price;
        
        sales.push({ name: item.name, paid: paid, date: new Date().toLocaleString('ar-EG') });
        
        if(item.type === 'Ø§Ø³Ø¨ÙŠØ±' && item.qty > 1) inventory[index].qty--;
        else inventory.splice(index, 1);
        
        update();
    }

    function clearSales() {
        if(confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø³Ø¬Ù„ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ØŸ Ø³ÙŠØªÙ… ØªØµÙÙŠØ± Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­.")) {
            sales = [];
            update();
        }
    }

    function clearInventory() {
        if(confirm("ğŸš¨ ØªØ­Ø°ÙŠØ± Ø®Ø·ÙŠØ±: Ù‡Ù„ ØªØ±ÙŠØ¯ Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ø¨Ø¶Ø§Ø¹Ø© Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Ø§Ù„Ù…Ø®Ø²Ù†ØŸ")) {
            inventory = [];
            update();
        }
    }

    function update() {
        localStorage.setItem('m_inv', JSON.stringify(inventory));
        localStorage.setItem('m_sales', JSON.stringify(sales));
        render();
    }

    function render() {
        document.querySelector('#invTable tbody').innerHTML = inventory.map((it, i) => `
            <tr><td>${it.name}</td><td>${it.type==='Ù‡Ø§ØªÙ'?it.detail:'ÙƒÙ…ÙŠØ©: '+it.qty}</td>
            <td class="price-text">${it.price.toLocaleString()}</td>
            <td><button onclick="sell(${i})" class="btn-sell">Ø¨ÙŠØ¹</button></td></tr>`).join('');
        
        document.querySelector('#salesTable tbody').innerHTML = sales.slice(-10).reverse().map(s => `
            <tr><td>${s.name}</td><td class="price-text">${s.paid.toLocaleString()}</td><td>${s.date}</td></tr>`).join('');

        const invTotal = inventory.reduce((sum, it) => sum + (it.price * (it.type === 'Ø§Ø³Ø¨ÙŠØ±' ? it.qty : 1)), 0);
        const salesTotal = sales.reduce((sum, s) => sum + s.paid, 0);

        document.getElementById('totalInvPrice').innerText = invTotal.toLocaleString() + " Ø¬.Ø³";
        document.getElementById('totalSalesCash').innerText = salesTotal.toLocaleString() + " Ø¬.Ø³";
        document.getElementById('countInv').innerText = inventory.length;
        document.getElementById('countSales').innerText = sales.length;
    }

    function exportToExcel() {
        if(sales.length === 0) return alert("Ø§Ù„Ø³Ø¬Ù„ ÙØ§Ø±Øº Ø­Ø§Ù„ÙŠØ§Ù‹");
        const ws = XLSX.utils.json_to_sheet(sales);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª");
        XLSX.writeFile(wb, "Ù…Ø¨ÙŠØ¹Ø§Øª_Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©.xlsx");
    }
</script>
</body>
</html>
